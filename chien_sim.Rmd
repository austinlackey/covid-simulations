##todo

```{r}
set.seed(400)
library(tidyverse)
library(dplyr)
library(pracma)
```

## R Markdown


```{r cars}
data <- read_csv("owid-covid-data.csv")
```

```{r}
china <- data %>% 
  filter(location=="China") %>% 
  filter(date <= "2020-03-28") %>% 
  filter(date >= "2020-01-22") %>% 
  select(date, total_cases, total_deaths) %>% 
  mutate(days = c(1:67))
```

```{r}
ggplot() +
  geom_point(aes(x = date, y = total_cases), data = china)
#+ geom_smooth(aes(x = date, y = total_cases), data=italy)
ggplot() +
  geom_point(aes(x = date, y = total_deaths), data = china)
#+ geom_smooth(aes(x = date, y = total_deaths), data=italy)
```

```{r}
x <- 1:67
ggplot(china,aes(x)) +
  geom_point(aes(x = days, y = total_cases)) +
  stat_function(fun=function(x) 40000 + 40000 * erf(0.11*x - 2))

ggplot(china,aes(x)) +
  geom_point(aes(x = days, y = total_deaths)) +
  stat_function(fun=function(x) 1600 + 1600 * erf(0.071*x - 1.8))
```

```{r}
italy <- data %>% 
  filter(location=="Italy") %>% 
  filter(date <= "2020-04-21") %>%
  filter(date >= "2020-02-15") %>%
  select(date, total_cases, total_deaths) %>% 
  mutate(days = c(1:67))
italy[45:67,] <- NA
```

```{r}
ggplot() +
  geom_point(aes(x = date, y = total_cases), data = italy)
#+ geom_smooth(aes(x = date, y = total_cases), data=italy)
ggplot() +
  geom_point(aes(x = date, y = total_deaths), data = italy)
#+ geom_smooth(aes(x = date, y = total_deaths), data=italy)
```


```{r}
x <- 1:67
ggplot(italy,aes(x)) +
  geom_point(aes(x = days, y = total_cases)) +
  stat_function(fun=function(x) 100000 + 100000 * erf(0.07*x - 3))

ggplot(italy,aes(x)) +
  geom_point(aes(x = days, y = total_deaths)) +
  stat_function(fun=function(x) 11000 + 11000 * erf(0.068*x - 3))
```

```{r}
italy = italy[1:44,]
n <- 44 # number of observed days
m <- 150 # number of random outcomes

# the Gaussian distribution (Normal) with mean = 1 and sigma = 0.1
mu <- 1
sig <- 0.1 # Gaussian distributed with a 10% standard deviation

# each number in the matrix is part of a Gaussian distribution
df <- matrix(rnorm(n*m, mu, sig), nrow=m, ncol=n)

# multiplied the nominal value of the diagnosed positive cases of the jth day for the 150 numbers of the jth column of the random matrix mentioned above
mc_data <- vector()
for (j in 1:n){
  mc_data <- c(mc_data, italy$total_cases[j]*df[,j])
}

mc_data <- matrix(mc_data, nrow=m, ncol=n)  # daily data to obtain 150 series of cases
head(mc_data)
```

